{% extends "base.html" %}
{% block content %}

<section class="py-5 bg-light rounded-3" style="background:linear-gradient(180deg,#f5f9ff,#ffffff);">
    <div class="container">
        <div class="row align-items-center g-4">
            <div class="col-lg-7">
            <h1 class="display-5 fw-bold" style="line-height:1.1;">
                Aprende y comparte con estrategias <span class="text-primary">participativas</span>
        </h1>
        <p class="lead text-muted mt-3">Foros, debates, talleres, simposios y más en un solo lugar</p>
        <a class="btn btn-primary btn-lg mt-2"
            href="{{ url_for('eventos.eventos_list') }}">
            Explorar eventos
        </a>
            </div>
        <div class="col-lg-5 text-center">
        <img src="https://images.unsplash.com/photo-1557425529-b1ae9c141e7d?auto=format&fit=crop&w=1100&q=60"
            alt="Personas conversando" class="img-fluid rounded-3 shadow-sm">
    </div>
        </div>
    </div>
</section>

<div class="container mt-5">
    <h2 class="h3 mb-4">Próximos eventos</h2>
    <div class="row">
    <!-- FILTROS (sin JS: GET con botón) -->
    <aside class="col-lg-3 mb-4">
    <form method="get" class="card p-3 shadow-sm">
        <h6 class="text-uppercase text-muted mb-3">Tipo de evento</h6>
        {% for t in ["foro","debate","taller","seminario","conferencia","panel de expertos"] %}
        <div class="form-check mb-1">
            <input class="form-check-input" type="checkbox" name="tipo" value="{{t}}" id="t-{{loop.index}}"
                {% if t in tipos_seleccionados %}checked{% endif %}>
            <label class="form-check-label" for="t-{{loop.index}}">{{ t|capitalize }}</label>
        </div>
        {% endfor %}
        <button class="btn btn-outline-primary mt-3">Aplicar filtros</button>
    </form>
    </aside>

    <!-- GRID DE TARJETAS -->
    <section class="col-lg-9">
    <div class="row g-4">
        {% for e in eventos %}
        <div class="col-md-6 col-xl-4">
        <div class="card h-100 shadow-sm">
            <img class="card-img-top" src="{{ e.tipo_evento|imagen_evento }}" alt="{{e.tipo_evento}}">
            <div class="card-body d-flex flex-column">
            <span class="badge text-bg-secondary mb-2">{{ e.tipo_evento|capitalize }}</span>
            <h5 class="card-title">{{ e.nombre }}</h5>
            <p class="small text-muted mb-1">
                {{ e.fecha_inicio|fecha_larga }}{% if e.fecha_fin %} – {{ e.fecha_fin|fecha_larga }}{% endif %}
            </p>
            <p class="small text-muted">{{ e.ciudad or e.lugar or 'Sin ubicación' }}</p>

<div class="mt-auto d-flex gap-2 flex-wrap">
    {% if current_user.is_authenticated and current_user.rol_id == 1 %}
        <form method="post" action="{{ url_for('eventos.inscribirme', eid=e.id_evento) }}">
            <button class="btn btn-primary" {% if e.id_evento in inscritas %}disabled{% endif %}>
                {% if e.id_evento in inscritas %}Inscrito{% else %}Inscribirse{% endif %}
            </button>
        </form>
    {% else %}
        <a class="btn btn-outline-primary" href="{{ url_for('auth.login') }}">Inscribirse</a>
    {% endif %}
    <a class="btn btn-light" href="{{ url_for('eventos.evento_detalle', eid=e.id_evento) }}">
        Más info
    </a>
</div>
            </div>
        </div>
        </div>
        {% else %}
        <div class="col-12">
            <div class="alert alert-light border">No hay eventos para los filtros seleccionados.</div>
        </div>
        {% endfor %}
        </div>
    </section>
    </div>
</div>

<!-- Botón flotante de contacto -->
<a href="{{ url_for('publico.contacto') }}" class="btn-contacto" title="Contáctanos" aria-label="Contáctanos">
    <i class="fas fa-envelope icono-normal"></i>
    <i class="fas fa-phone icono-hover"></i>
</a>

<!-- Font Awesome (si tu base no lo incluye ya) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
/* Estilos del botón flotante */
.btn-contacto {
    position: fixed;
    bottom: 25px;
    right: 25px;
    background-color: #0d6efd;
    color: white;
    border-radius: 50%;
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.25);
    transition: transform 0.18s ease, background-color 0.18s ease;
    z-index: 1100;
    text-decoration: none;
    overflow: hidden;
    position: fixed;
}

/* Íconos: sobre por defecto, teléfono en hover */
.btn-contacto .icono-hover {
    position: absolute;
    opacity: 0;
    transition: opacity 0.25s ease;
}
.btn-contacto:hover .icono-hover {
    opacity: 1;
}
.btn-contacto:hover .icono-normal {
    opacity: 0;
}

/* Hover general */
.btn-contacto:hover,
.btn-contacto:focus {
    background-color: #0b5ed7;
    transform: rotate(360deg) scale(1.1);
    outline: none;
}

/* Responsivo para móvil */
@media (max-width: 420px) {
    .btn-contacto {
        width: 52px;
        height: 52px;
        font-size: 20px;
        bottom: 18px;
        right: 18px;
    }
}
</style>

{% endblock %}
